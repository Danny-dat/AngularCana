<header class="app-header" (click)="closeDropdown()">
  <!-- Burger (Sidebar) -->
  <button class="icon-btn burger" aria-label="MenÃ¼" (click)="toggleSidebar($event)">
    <mat-icon fontSet="material-icons-outlined">menu</mat-icon>
  </button>

  <h2 class="title">{{ pageTitle }}</h2>

  <div class="header-actions" (click)="$event.stopPropagation()">
    <!-- Einstellungen -> Meine Daten -->
    <button
      class="icon-btn icon-btn--lg"
      aria-label="Einstellungen"
      (click)="$event.stopPropagation()"
      [routerLink]="'/me'">
      <mat-icon class="material-icons-outlined">settings</mat-icon>
    </button>

    <div class="bell-wrap">
      <button class="icon-btn" aria-label="Benachrichtigungen" (click)="toggleNotifications($event)">
        <mat-icon fontSet="material-icons-outlined">notifications_none</mat-icon>
        @if (unreadCount$ | async; as c) {
          <span class="badge" [class.show]="c > 0">{{ c }}</span>
        }
      </button>

      @if (showNotifications) {
        <div class="dropdown">
          @if (notifications$ | async; as list) {
            @if (!list?.length) {
              <div class="item empty">Keine Benachrichtigungen.</div>
            } @else {
              @for (n of list; track n.id) {
                <div class="item" [class.read]="n.read" (click)="markRead(n.id)">
                  <p>{{ n.message }}</p>
                  <small>{{ asDate(n.timestamp) | date:'EEE, dd.MM.yyyy, HH:mm' }}</small>
                </div>
              }
            }
          }
        </div>
      }
    </div>

    <span class="user-name">{{ userDisplayName }}</span>
  </div>
</header>

<app-app-sidenav
  [open]="showSidebar"
  (closed)="showSidebar=false"
  (logout)="logout()">
</app-app-sidenav>
